'use strict';let toc=document.getElementById('toc'),song=document.getElementById('song'),back=document.getElementById('back'),overlay=document.getElementById('overlay'),modal=document.getElementById('modal'),modalClose=modal.querySelector('.close'),refresh=document.getElementById('refresh'),modalBody=document.getElementById('modalBody'),navigation=[],songArray=[];populateNav(),initializeSongs(),document.addEventListener('keyup',a=>{27==a.which&&modalClose.click()}),overlay.addEventListener('click',()=>{showModal(!1)}),modalClose.addEventListener('click',()=>{showModal(!1)}),back.addEventListener('click',()=>{toc.removeAttribute('hidden'),song.setAttribute('hidden',''),back.setAttribute('disabled','')}),refresh.addEventListener('click',()=>{localStorage.removeItem('songs'),location.reload(!0)});function populateNav(){navigation=toc.querySelectorAll('span');for(let a=0;a<navigation.length;a++)navigation[a].addEventListener('click',function(){let a=this.innerText;a=a.replace(/-/g,' '),a=a.split(' '),showRecords(a)})}function showRecords(a){var b=Number.parseInt;for(showModal(!0);modalBody.firstChild;)modalBody.removeChild(modalBody.firstChild);if('All'===a[0]){let a=songArray.length;for(let b=0;b<a;b++){let a=document.createElement('div'),c=document.createElement('span');c.classList.add('num'),c.innerText=b+1,a.appendChild(c),a.onclick=function(a){return function(){showSong(a)}}(b),a.innerText=songArray[b].title,modalBody.append(a),a.appendChild(c)}}else if(Number.isInteger(b(a[0])))for(let c=b(a[0])-1;c<b(a[1]);c++){let a=document.createElement('div'),b=document.createElement('span');b.classList.add('num'),b.innerText=c+1,a.appendChild(b),a.onclick=function(a){return function(){showSong(a)}}(c),a.innerText=songArray[c].title,modalBody.append(a),a.appendChild(b)}else{let b=Object.keys(songArray).length,c=[];for(let d=0;d<b;d++)songArray[d].title.charAt(0)===a[0]&&c.push([songArray[d].title,d]);c.sort(function(c,a){return c[0].toUpperCase().localeCompare(a[0].toUpperCase())});for(let a=0;a<c.length;a++){let b=document.createElement('div'),d=document.createElement('span');d.classList+='num',d.innerText=c[a][1]+1,b.onclick=function(a){return function(){showSong(c[a][1])}}(a),b.innerText=c[a][0],modalBody.append(b),b.appendChild(d)}}}function showModal(a){a?(modal.classList.add('active'),overlay.classList.add('active')):(modal.classList.remove('active'),overlay.classList.remove('active'))}function showSong(a){let b=songArray[a],c=[],d=b.number,e=b.title,f=b.verse,g=b.chorus,h=b.author;song.innerHTML='',c.push(d,e,f,g,h);let j=c.length,k=document.createElement('div');k.classList.add('songHeader');for(let b=0;b<j;b++)switch(b){case 0:if(c[b]){let a=document.createElement('div');a.classList.add('songNum'),a.innerText=c[b],k.insertAdjacentElement('beforeend',a)}break;case 1:if(c[b]){let a=document.createElement('div');a.classList.add('songTitle'),a.innerText=c[b],k.insertAdjacentElement('afterbegin',a),song.insertAdjacentElement('beforeend',k)}break;case 2:if(c[b]){let a=c[b].length+1;for(let d,e=0;e<a;e++)switch(d=document.createElement('div'),e){case 0:d.classList+='verse',d.innerText=cleanupString(c[b][e]),song.insertAdjacentElement('beforeend',d);break;case 1:0<c[3].length&&(d.classList+='chorus',d.innerText=cleanupString(c[3]),song.insertAdjacentElement('beforeend',d));break;default:d.classList+='verse',d.innerText=cleanupString(c[b][e-1]),song.insertAdjacentElement('beforeend',d);}}break;case 4:if(c[b]){let a=document.createElement('div');a.classList+='author',a.innerText=c[b],song.insertAdjacentElement('beforeend',a)}}return toc.setAttribute('hidden',''),song.removeAttribute('hidden'),back.removeAttribute('disabled'),modalClose.click(),!1}function cleanupString(a){let b=a.replace(/\*/g,'').replace(/\s{2,}/g,'\n').trim();return b}async function initializeSongs(){function a(){return new Promise(async a=>{let b=await fetch('js/songs.json');if(b.ok)console.info('Song database found!'),a(b.json());else throw`File "${'js/songs.json'}" not found on server!`}).catch(a=>{console.error(a)})}function b(a){return new Promise(b=>{console.info('Loading song data...'),localStorage.setItem('songs',JSON.stringify(a)),b()})}localStorage.hasOwnProperty('songs')||(console.info('Searching for list of songs...'),await async function(){let c=await a();return await b(c),new Promise(a=>{a()}).catch(a=>{console.error(a)})}()),songArray=await function(){return new Promise(a=>{console.info('Loading songs into memory...'),a(JSON.parse(localStorage.getItem('songs')))})}()}

