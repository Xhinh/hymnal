'use strict';var initializeSongs=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b,c,d,e=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(){var b;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c();case 2:return b=a.sent,a.next=5,d(b);case 5:return a.abrupt('return',new Promise(function(a){a()}).catch(function(a){console.error(a)}));case 6:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}();return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(d=function(a){return new Promise(function(b){console.info('Loading song data...'),localStorage.setItem('songs',JSON.stringify(a)),b()})},c=function(){var a=this;return new Promise(function(){var b=_asyncToGenerator(regeneratorRuntime.mark(function b(c){var d,e;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d='js/songs.json',a.next=3,fetch(d);case 3:if(e=a.sent,!e.ok){a.next=9;break}console.info('Song database found!'),c(e.json()),a.next=10;break;case 9:throw'File "'+d+'" not found on server!';case 10:case'end':return a.stop();}},b,a)}));return function(){return b.apply(this,arguments)}}()).catch(function(a){console.error(a)})},b=function(){return new Promise(function(a){console.info('Loading songs into memory...'),a(JSON.parse(localStorage.getItem('songs')))})},localStorage.hasOwnProperty('songs')){a.next=7;break}return console.info('Searching for list of songs...'),a.next=7,e();case 7:return a.next=9,b();case 9:songArray=a.sent;case 10:case'end':return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}();function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}var toc=document.getElementById('toc'),song=document.getElementById('song'),back=document.getElementById('back'),modal=document.getElementById('overlay'),modalClose=modal.querySelector('.close'),refresh=document.getElementById('refresh'),modalBody=document.getElementById('modalBody'),navigation=[],songArray=[];populateNav(),initializeSongs(),document.addEventListener('keyup',function(a){27==a.which&&modalClose.click()}),modal.addEventListener('click',function(){showModal(!1)}),modalClose.addEventListener('click',function(){showModal(!1)}),back.addEventListener('click',function(){toc.removeAttribute('hidden'),song.setAttribute('hidden',''),back.setAttribute('disabled','')}),refresh.addEventListener('click',function(){localStorage.removeItem('songs'),location.reload(!0)});function populateNav(){navigation=toc.querySelectorAll('span');for(var a=0;a<navigation.length;a++)navigation[a].addEventListener('click',function(){var a=this.innerText;a=a.replace(/-/g,' '),a=a.split(' '),showRecords(a)})}function showRecords(a){for(var b=Number.parseInt;modalBody.firstChild;)modalBody.removeChild(modalBody.firstChild);if('All'===a[0])for(var c=songArray.length,d=0;d<c;d++){var e=document.createElement('div'),f=document.createElement('span');f.classList.add('num'),f.innerText=d+1,e.appendChild(f),e.onclick=function(a){return function(){showSong(a)}}(d),e.innerText=songArray[d].title,modalBody.append(e),e.appendChild(f)}else if(Number.isInteger(b(a[0])))for(var g=b(a[0])-1;g<b(a[1]);g++){var h=document.createElement('div'),j=document.createElement('span');j.classList.add('num'),j.innerText=g+1,h.appendChild(j),h.onclick=function(a){return function(){showSong(a)}}(g),h.innerText=songArray[g].title,modalBody.append(h),h.appendChild(j)}else(function(){for(var b=Object.keys(songArray).length,c=[],d=0;d<b;d++)songArray[d].title.charAt(0)===a[0]&&c.push([songArray[d].title,d]);c.sort(function(c,a){return c[0].toUpperCase().localeCompare(a[0].toUpperCase())});for(var e=0;e<c.length;e++){var f=document.createElement('div'),g=document.createElement('span');g.classList+='num',g.innerText=c[e][1]+1,f.onclick=function(a){return function(){showSong(c[a][1])}}(e),f.innerText=c[e][0],modalBody.append(f),f.appendChild(g)}})();showModal(!0)}function showModal(a){a?modal.classList.add('active'):modal.classList.remove('active')}function showSong(a){var b=songArray[a],c=[],d=b.number,e=b.title,f=b.verse,g=b.chorus,h=b.author;song.innerHTML='',c.push(d,e,f,g,h);var k=c.length,l=document.createElement('div');l.classList.add('songHeader');for(var p=0;p<k;p++)switch(p){case 0:if(c[p]){var i=document.createElement('div');i.classList.add('songNum'),i.innerText=c[p],l.insertAdjacentElement('beforeend',i)}break;case 1:if(c[p]){var q=document.createElement('div');q.classList.add('songTitle'),q.innerText=c[p],l.insertAdjacentElement('afterbegin',q),song.insertAdjacentElement('beforeend',l)}break;case 2:if(c[p])for(var m,n=c[p].length+1,o=0;o<n;o++)switch(m=document.createElement('div'),o){case 0:m.classList+='verse',m.innerText=cleanupString(c[p][o]),song.insertAdjacentElement('beforeend',m);break;case 1:0<c[3].length&&(m.classList+='chorus',m.innerText=cleanupString(c[3]),song.insertAdjacentElement('beforeend',m));break;default:m.classList+='verse',m.innerText=cleanupString(c[p][o-1]),song.insertAdjacentElement('beforeend',m);}break;case 4:if(c[p]){var r=document.createElement('div');r.classList+='author',r.innerText=c[p],song.insertAdjacentElement('beforeend',r)}}return toc.setAttribute('hidden',''),song.removeAttribute('hidden'),back.removeAttribute('disabled'),modalClose.click(),!1}function cleanupString(a){var b=a.replace(/\*/g,'').replace(/\s{2,}/g,'\n').trim();return b}
